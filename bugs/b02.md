# Bug B02: Shell Injection Vulnerability in PR Creation

## Severity
**Critical** - Security Vulnerability

## Location
`src/worktreeflow/wtf.py:1143-1156`

## Description
The PR creation command is vulnerable to shell injection through malicious commit messages. The escaping mechanism is incomplete and doesn't handle all shell metacharacters.

## Current Code
```python
# Escape quotes in title and body to prevent shell injection
title_escaped = title.replace('"', '\\"').replace('$', '\\$').replace('`', '\\`')
body_escaped = body.replace('"', '\\"').replace('$', '\\$').replace('`', '\\`')

# Use heredoc for body to handle multiline content
pr_cmd = f'''gh pr create \\
    --repo "{self.upstream_repo}" \\
    --head "{self.fork_owner}:{branch_name}" \\
    --base "{base}" \\
    --title "{title_escaped}" \\
    --body "{body_escaped}" \\
    {draft_flag}'''

result = self.logger.execute(pr_cmd, f"Create {create_type}")
```

## Problem
The escaping doesn't handle:
- Newlines (`\n`)
- Semicolons (`;`)
- Pipes (`|`)
- Redirects (`>`, `<`)
- Command substitution (`$()`)
- Other shell metacharacters

A malicious commit message like:
```
feat: add feature\n; rm -rf /; echo "
```

Could potentially execute arbitrary commands when executed with `shell=True`.

## Impact
**High security risk**: Arbitrary command execution if an attacker can control commit messages (e.g., through a malicious PR that gets rebased onto).

## Proposed Fix
Replace shell string construction with proper subprocess argument list:

```python
# Build command as argument list (safe from injection)
cmd_args = [
    'gh', 'pr', 'create',
    '--repo', self.upstream_repo,
    '--head', f"{self.fork_owner}:{branch_name}",
    '--base', base,
    '--title', title,
    '--body', body
]

if draft:
    cmd_args.append('--draft')

# Update execute method to support argument lists
result = subprocess.run(
    cmd_args,
    check=check,
    capture_output=True,
    text=True
)
```

## Alternative Fix
If maintaining the logger interface, at minimum use proper shell escaping:

```python
from shlex import quote

pr_cmd = [
    'gh', 'pr', 'create',
    '--repo', quote(self.upstream_repo),
    '--head', quote(f"{self.fork_owner}:{branch_name}"),
    '--base', quote(base),
    '--title', quote(title),
    '--body', quote(body),
]

if draft:
    pr_cmd.append('--draft')

result = self.logger.execute(' '.join(pr_cmd), f"Create {create_type}")
```

## Recommendation
This affects all places where user-controlled strings are interpolated into shell commands. A full audit of all `logger.execute()` calls is recommended.
