# Bug B12: Unformatted datetime in User Messages

## Severity
**Low Priority** - Cosmetic Issue

## Location
- `src/worktreeflow/wtf.py:298`
- `src/worktreeflow/wtf.py:800`
- `src/worktreeflow/wtf.py:1267`

## Description
When creating automated stash messages and backup branches, the code uses `datetime.now()` directly, which includes microseconds and isn't user-friendly.

## Current Code

### Location 1: Auto-stash in check_uncommitted_changes() - Line 298
```python
if repo.is_dirty(untracked_files=True):
    if stash:
        console.print("[yellow]Stashing uncommitted changes...[/yellow]")
        repo.git.stash("push", "-m", f"wtf auto-stash {datetime.now()}")
        return True
```

**Output:**
```
wtf auto-stash 2025-11-09 14:23:45.123456
```

### Location 2: Backup branch in sync_main_force() - Line 800
```python
# Create backup branch
backup_branch = f"backup/{base}-{datetime.now().strftime('%Y%m%d-%H%M%S')}"
console.print(f"Creating backup branch: {backup_branch}")
```

**Output:**
```
backup/main-20251109-142345
```
This one is actually formatted correctly! ✓

### Location 3: Backup branch in wt_update() - Line 1267
```python
if not no_backup and commits_ahead > 0:
    backup_branch = f"backup/{branch_name}-{datetime.now().strftime('%Y%m%d-%H%M%S')}"
    console.print(f"Creating backup branch: {backup_branch}")
```

**Output:**
```
backup/feat/my-feature-20251109-142345
```
This one is also formatted correctly! ✓

### Location 4: Auto-stash in wt_update() - Line 1254
```python
if has_uncommitted:
    if stash:
        console.print("Stashing uncommitted changes...")
        stash_cmd = f'git -C "{git_dir}" stash push -m "wt-update auto-stash for {branch_name}"'
        self.logger.execute(stash_cmd, "Stash changes")
        stashed = True
```

This one doesn't use datetime at all, just a descriptive message. ✓

## Problem
**Only Location 1 (line 298)** has the issue - it uses raw `datetime.now()` which outputs:
```
2025-11-09 14:23:45.123456
```

This includes:
- Microseconds (`.123456`) - unnecessarily precise and noisy
- Full timestamp format - verbose

While functional, it's not as clean as it could be.

## Impact
- **Minimal**: Just cosmetic
- Stash messages are slightly messy
- Users can still identify and pop the right stash
- No functional problems

## Proposed Fix

### Option 1: Match the format used in backup branches
```python
if repo.is_dirty(untracked_files=True):
    if stash:
        console.print("[yellow]Stashing uncommitted changes...[/yellow]")
        timestamp = datetime.now().strftime('%Y%m%d-%H%M%S')
        repo.git.stash("push", "-m", f"wtf auto-stash {timestamp}")
        return True
```

**Output:**
```
wtf auto-stash 20251109-142345
```

### Option 2: Human-readable format
```python
if repo.is_dirty(untracked_files=True):
    if stash:
        console.print("[yellow]Stashing uncommitted changes...[/yellow]")
        timestamp = datetime.now().strftime('%Y-%m-%d %H:%M:%S')
        repo.git.stash("push", "-m", f"wtf auto-stash {timestamp}")
        return True
```

**Output:**
```
wtf auto-stash 2025-11-09 14:23:45
```

### Option 3: ISO 8601 format (most standard)
```python
if repo.is_dirty(untracked_files=True):
    if stash:
        console.print("[yellow]Stashing uncommitted changes...[/yellow]")
        timestamp = datetime.now().strftime('%Y-%m-%dT%H:%M:%S')
        repo.git.stash("push", "-m", f"wtf auto-stash {timestamp}")
        return True
```

**Output:**
```
wtf auto-stash 2025-11-09T14:23:45
```

### Option 4: Descriptive without timestamp
```python
if repo.is_dirty(untracked_files=True):
    if stash:
        console.print("[yellow]Stashing uncommitted changes...[/yellow]")
        # Get current branch name for context
        try:
            branch = repo.active_branch.name
        except:
            branch = "detached"
        repo.git.stash("push", "-m", f"wtf auto-stash on {branch}")
        return True
```

**Output:**
```
wtf auto-stash on main
```

## Recommendation
**Option 1** (match backup format) for consistency:
```python
timestamp = datetime.now().strftime('%Y%m%d-%H%M%S')
repo.git.stash("push", "-m", f"wtf auto-stash {timestamp}")
```

This makes stash messages consistent with backup branch naming.

## Additional Consideration
The stash message could also include the command that triggered it:
```python
repo.git.stash("push", "-m", f"wtf auto-stash: sync-main {timestamp}")
```

This would help users identify why the stash was created when they have multiple auto-stashes.

## Testing
Check stash messages:
```bash
git stash list
# Before: stash@{0}: On main: wtf auto-stash 2025-11-09 14:23:45.123456
# After:  stash@{0}: On main: wtf auto-stash 20251109-142345
```

Both are functional, but the after version is cleaner.
