# Bug B10: Inconsistent Title/Body Default Checks

## Severity
**Low Priority** - Edge Case

## Location
- `src/worktreeflow/wtf.py:1113`
- `src/worktreeflow/wtf.py:1125`

## Description
The logic for determining whether to auto-generate PR title and body has a subtle bug: it regenerates even when a user explicitly provides a value that matches the default.

## Current Code
```python
def wt_pr(self, slug: str, base: str = "main", title: Optional[str] = None,
          body: Optional[str] = None, draft: bool = False) -> None:
    # ... earlier code ...

    # Generate PR title and body if not provided
    if not title or title == f"feat: {slug}":  # Line 1113
        # Try to use last commit message
        result = self.logger.execute(
            f'git -C "{git_dir}" log -1 --pretty=format:"%s"',
            "Get last commit message",
            check=False
        )
        if not self.dry_run and result.stdout:
            title = result.stdout.strip()
        else:
            title = f"feat: {slug}"

    if not body or body == "Summary, rationale, tests":  # Line 1125
        # Generate body from commits
        result = self.logger.execute(
            f'git -C "{git_dir}" log "upstream/{base}..HEAD" --pretty=format:"- %s"',
            "Get commit messages",
            check=False
        )
        if not self.dry_run and result.stdout:
            body = f"## Changes\n\n{result.stdout}\n\n## Testing\n\n- [ ] Tests pass\n- [ ] Manual testing completed"
        else:
            body = "## Summary\n\nAdd description here\n\n## Testing\n\n- [ ] Tests pass"
```

## Problem

### Issue 1: Title Check
If a user explicitly wants the title to be `"feat: my-feature"` (matching the default), the tool will override it with the last commit message:

```bash
# User explicitly sets title
$ wtf wt-pr my-feature --title "feat: my-feature"

# But the code thinks: "title == f'feat: {slug}', so regenerate!"
# Result: Title gets replaced with last commit message
```

The condition `if not title or title == f"feat: {slug}":` means:
- `not title`: Generate if None/empty ✓ (correct)
- `title == f"feat: {slug}"`: Generate if matches default ✗ (wrong - might be intentional)

### Issue 2: Body Check
Similarly, if the body happens to be exactly `"Summary, rationale, tests"`, it gets regenerated:

```bash
$ wtf wt-pr my-feature --body "Summary, rationale, tests"
# Gets replaced with auto-generated body
```

### Issue 3: Unclear Intent
The current code conflates two different scenarios:
1. User didn't provide a value → auto-generate
2. User provided the default value → ??? (current: regenerate, unclear if intentional)

## Impact
- **Low practical impact**: Users rarely explicitly set values to match defaults
- **Confusing behavior**: When it does happen, it's unexpected
- **Intent unclear**: Hard to tell if this is a feature or bug

## Proposed Fix

### Option 1: Only check for None/empty
```python
# Generate PR title if not provided
if not title:
    # Try to use last commit message
    result = self.logger.execute(
        f'git -C "{git_dir}" log -1 --pretty=format:"%s"',
        "Get last commit message",
        check=False
    )
    if not self.dry_run and result.stdout:
        title = result.stdout.strip()
    else:
        title = f"feat: {slug}"

if not body:
    # Generate body from commits
    result = self.logger.execute(
        f'git -C "{git_dir}" log "upstream/{base}..HEAD" --pretty=format:"- %s"',
        "Get commit messages",
        check=False
    )
    if not self.dry_run and result.stdout:
        body = f"## Changes\n\n{result.stdout}\n\n## Testing\n\n- [ ] Tests pass\n- [ ] Manual testing completed"
    else:
        body = "## Summary\n\nAdd description here\n\n## Testing\n\n- [ ] Tests pass"
```

### Option 2: Use sentinel value to distinguish
```python
# At function signature
TITLE_AUTO = object()  # Sentinel
BODY_AUTO = object()

def wt_pr(self, slug: str, base: str = "main",
          title: Optional[str] = TITLE_AUTO,
          body: Optional[str] = BODY_AUTO,
          draft: bool = False) -> None:
    # ...

    if title is TITLE_AUTO:
        # Auto-generate title
        # ...

    if body is BODY_AUTO:
        # Auto-generate body
        # ...
```

But this doesn't work well with Click's CLI interface.

### Option 3: Add explicit flag
```python
@cli.command('wt-pr')
@click.argument('slug')
@click.option('--base', default='main', help='Base branch for PR')
@click.option('--title', help='PR title (auto-generated if not provided)')
@click.option('--body', help='PR body (auto-generated if not provided)')
@click.option('--draft', is_flag=True, help='Create as draft PR')
@click.option('--no-auto-title', is_flag=True, help='Do not auto-generate title')
@click.option('--no-auto-body', is_flag=True, help='Do not auto-generate body')
@click.pass_obj
def wt_pr(manager, slug, base, title, body, draft, no_auto_title, no_auto_body):
    """Open PR from fork feature to upstream/main (requires gh CLI)."""
    manager.wt_pr(slug, base, title, body, draft,
                  auto_title=not no_auto_title,
                  auto_body=not no_auto_body)
```

## Recommendation
**Option 1** is simplest and most predictable:
- Empty/None → auto-generate
- Any explicit value → use as-is (even if it matches the default)

The current behavior of checking for specific default strings is too clever and creates edge cases.

## Alternative Interpretation
It's possible the current behavior is intentional:
- "If you pass the boring default, I'll try to find something better"
- But this isn't documented and seems unintuitive

If this is the desired behavior, it should be documented:
```python
if not title or title == f"feat: {slug}":
    # Auto-generate title if not provided or if it's just the default slug
    # (we try to find a better title from commit messages)
    # ...
```

## Testing
Add test cases:
```python
# Explicit value matching default should be preserved
wt_pr(slug="my-feature", title="feat: my-feature")
# Expected: title = "feat: my-feature"
# Current: title = <last commit message>

# Empty value should auto-generate
wt_pr(slug="my-feature", title=None)
# Expected: title = <auto-generated>
# Current: title = <auto-generated> ✓
```
