# Bug B08: Hardcoded Default Upstream Repository

## Severity
**Medium Priority** - Configuration Issue

## Location
`src/worktreeflow/wtf.py:49`

## Description
The default upstream repository is hardcoded to a specific project ("humanlayer/humanlayer"), which will be incorrect for all other users and repositories.

## Current Code
```python
class RepoConfig:
    """
    Repository-specific configuration - modify these for your repo.
    This centralizes all repo-specific settings for easy customization.
    """

    # Repository defaults
    DEFAULT_UPSTREAM_REPO = "humanlayer/humanlayer"  # Format: owner/repo
    DEFAULT_BASE_BRANCH = "main"  # or "master", "develop", etc.
```

## Problem
1. **Wrong defaults for other projects**: Any user working on a different repository will have an incorrect upstream
2. **Confusion**: Users may not realize they need to configure this
3. **Misleading behavior**: Commands might attempt to use the wrong upstream
4. **Documentation gap**: The comment says "modify these for your repo" but this is a published package, not a single-repo script

## Impact
- Users of the tool on other repositories will get:
  - Wrong PR targets
  - Incorrect upstream sync operations
  - Confusing error messages
- The tool appears to be project-specific rather than general-purpose

## Example Problem Scenario
```bash
# User working on "myorg/myproject"
$ wtf doctor
Repo root:      /path/to/myproject
Repo name:      myproject
Upstream repo:  humanlayer/humanlayer  # <-- WRONG!
Fork owner:     myusername

$ wtf wt-pr my-feature
Creating PR for feat/my-feature...
[red]ERROR: Repository humanlayer/humanlayer not found[/red]
```

## Proposed Solutions

### Option 1: Detect from existing remotes (Best)
```python
class RepoConfig:
    # Repository defaults
    DEFAULT_UPSTREAM_REPO = None  # Will be auto-detected from 'upstream' remote
    DEFAULT_BASE_BRANCH = "main"
```

Then in `_detect_upstream_repo()`:
```python
def _detect_upstream_repo(self) -> None:
    """Detect upstream repository from remote."""
    self.upstream_repo = None

    if RepoConfig.UPSTREAM_REMOTE in self.repo.remotes:
        upstream_url = self.repo.remote("upstream").url
        self.logger.log("git remote get-url upstream", "Get upstream URL")

        # Parse repo from URL
        match = re.search(r'(?:github\.com[:/])([^/]+/[^/.]+)', upstream_url)
        if match:
            self.upstream_repo = match.group(1).replace(".git", "")

    # Only use default if nothing detected and it's set
    if not self.upstream_repo and RepoConfig.DEFAULT_UPSTREAM_REPO:
        self.upstream_repo = RepoConfig.DEFAULT_UPSTREAM_REPO
        console.print(f"[yellow]Using default upstream: {self.upstream_repo}[/yellow]")
        console.print("[yellow]Run 'wtf upstream-add' to configure correctly[/yellow]")
    elif not self.upstream_repo:
        console.print("[yellow]No upstream configured[/yellow]")
        console.print("[yellow]Run 'wtf upstream-add <owner/repo>' to set up[/yellow]")
```

### Option 2: Make it required configuration
```python
class RepoConfig:
    # Repository defaults - MUST be configured per repository
    DEFAULT_UPSTREAM_REPO = None  # Set via: wtf upstream-add owner/repo
    DEFAULT_BASE_BRANCH = "main"
```

Add validation in commands that need it:
```python
def _check_upstream_configured(self):
    if not self.upstream_repo:
        console.print("[red]Upstream repository not configured[/red]")
        console.print("Configure it with:")
        console.print("  wtf upstream-add owner/repo")
        sys.exit(1)
```

### Option 3: Use environment variable or config file
```python
import os

class RepoConfig:
    DEFAULT_UPSTREAM_REPO = os.getenv(
        'WTF_UPSTREAM_REPO',
        None  # No default
    )
```

Or support a `.wtf.config` file:
```python
# .wtf.config (gitignore'd or per-repo)
upstream_repo = "owner/repo"
base_branch = "main"
```

## Recommendation
**Option 1** (auto-detect from remotes) is the best approach because:
- Works automatically for most users
- Falls back gracefully when not configured
- Guides users to fix configuration
- No manual configuration needed for standard fork workflows

## Implementation Priority
Medium - This should be fixed before wider release to avoid confusing new users.

## Documentation Update Needed
Update README to explain:
1. How upstream is detected
2. How to set it manually if auto-detection fails
3. That the tool is general-purpose, not project-specific
